<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Information Element for Flow Discard Classification</title>
<meta content="John Evans" name="author">
<meta content="Oleksandr Pylypenko" name="author">
<meta content="Karim Cheaito" name="author">
<meta content="
       This document defines an IPFIX Information Element for classifying flow-level discards that aligns with the information model defined in  . The flowDiscardClass Information Element provides consistent classification of packet discards across IPFIX implementations, enabling correlation between device, interface and control-plane discards and the impacted flows. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-evans-opsawg-ipfix-discard-class-ie-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-evans-opsawg-ipfix-discard-class-ie.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">IE for Flow Discard Classification</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Evans, et al.</td>
<td class="center">Expires 22 March 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OPSAWG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-evans-opsawg-ipfix-discard-class-ie-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-18" class="published">18 September 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-03-22">22 March 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Evans</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">O. Pylypenko</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">K. Cheaito</div>
<div class="org">Amazon</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Information Element for Flow Discard Classification</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines an IPFIX Information Element for classifying flow-level discards that aligns with the information model defined in <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span>. The flowDiscardClass Information Element provides consistent classification of packet discards across IPFIX implementations, enabling correlation between device, interface and control-plane discards and the impacted flows.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 22 March 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-information-element" class="internal xref">Information Element</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-design-rationale" class="internal xref">Design Rationale</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-flowdiscardclass-definition" class="internal xref">flowDiscardClass Definition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-flowdiscardclass-values" class="internal xref">flowDiscardClass Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-implementation-requirements" class="internal xref">Implementation Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-semantics-and-scope" class="internal xref">Semantics and Scope</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-exporter-requirements" class="internal xref">Exporter Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-collector-requirements" class="internal xref">Collector Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="auto internal xref">3.4.4</a>.  <a href="#name-interoperability-with-exist" class="internal xref">Interoperability with Existing IPFIX IEs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-new-ipfix-information-eleme" class="internal xref">New IPFIX Information Element: flowDiscardClass</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-new-subregistry-flowdiscard" class="internal xref">New Subregistry: “flowDiscardClass Values”</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-correlating-flow-discards-w" class="internal xref">Correlating Flow Discards with Interface/Device/Control-Plane Discards</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-correlation-keys" class="internal xref">Correlation Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-analysis-strategies" class="internal xref">Analysis Strategies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-operational-example-impacte" class="internal xref">Operational Example: Impacted Flows (Congestion Drops)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-operational-example-causal-" class="internal xref">Operational Example: Causal Flows (Congestion Drops)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-implementation-note-on-samp" class="internal xref">Implementation Note on Sampling</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">For network operators, understanding both where and why packet loss occurs within a network is essential for effective operation. While certain types of packet loss, such as policy-based discards, are intentional and part of normal network operation, unintended packet loss can impact customer services. To automate network operations, operators must be able to detect customer-impacting packet loss, determine its root cause, and apply appropriate mitigation actions.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span> addresses this need by defining an information model that provides precise classification of packet loss, enabling accurate automated mitigation. While its YANG data model implementation provides device, interface and control-plane discards, effective automated triage often requires understanding which specific flows are impacted. For example, when mitigating congestion, operators may need to identify and trace the sources of elephant flows. This requires the ability to correlate device and interface-level discard classes with the specific flows being dropped.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Currently, <span>[<a href="#RFC7270" class="cite xref">RFC7270</a>]</span> defines the forwardingStatus Information Element for reporting packet forwarding outcomes in IPFIX, including various reasons for packet drops. The defined drop reason codes lack the granularity and clarity needed for automated root cause analysis and impact mitigation, however. For instance, the "For us" reason code provides insufficient context to determine appropriate mitigation actions.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document addresses these limitations by introducing a new Information Element, flowDiscardClass, to provide a consistent classification scheme for packet discards across IPFIX implementations. This new element aligns with the classification scheme defined in <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span> and enables:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-5">
<li id="section-1-5.1">
          <p id="section-1-5.1.1">Precise detection of unintended packet loss through clear distinction between intended and unintended discards<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-5.2">
          <p id="section-1-5.2.1">Accurate root cause analysis through detailed classification of discard reasons<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-5.3">
          <p id="section-1-5.3.1">Automated selection of mitigation actions based on discard type, rate, and duration<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-5.4">
          <p id="section-1-5.4.1">Consistent reporting across vendor implementations in both YANG and IPFIX data models<a href="#section-1-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-6">By providing this mapping between YANG and IPFIX implementations, this document enables operators to correlate device-level statistics with flow-level impacts, facilitating more effective automated network operations.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">A packet discard accounts for any instance where a packet is dropped by a device, regardless of whether the discard was intentional or unintentional.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Intended discards are packets dropped due to deliberate network policies or configurations designed to enforce security or quality of service. For example, packets dropped because they match an Access Control List (ACL) denying certain traffic types.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Unintended discards are packets that were dropped, which the network operator otherwise intended to deliver, i.e. which indicates an error state.  There are many possible reasons for unintended packet loss, including: erroring links may corrupt packets in transit; incorrect routing tables may result in packets being dropped because they do not match a valid route; configuration errors may result in a valid packet incorrectly matching an ACL and being dropped.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Device discard counters do not by themselves establish operator intent. Discards reported under policy (e.g., ACL/policer) indicate only that traffic matched a configured rule; such discards may still be unintended if the configuration is in error. Determining intent for policy discards requires external context (e.g., configuration validation and change history) which is out of scope for this specification.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="informationelement">
<section id="section-3">
      <h2 id="name-information-element">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-information-element" class="section-name selfRef">Information Element</a>
      </h2>
<p id="section-3-1">This Information Element has been specified in accordance with the guidelines in <span>[<a href="#RFC7013" class="cite xref">RFC7013</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="rationale">
<section id="section-3.1">
        <h3 id="name-design-rationale">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-design-rationale" class="section-name selfRef">Design Rationale</a>
        </h3>
<p id="section-3.1-1">The mapping between <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span> and the IPFIX flowDiscardClass Information Element follows these principles, maintaining consistency with the YANG model while allowing self-contained decoding from a single IE:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-2">
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">Scope. The flowDiscardClass Information Element is specifically for reporting flow-level discard reasons, and therefore only represents the flow subtree from <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span>. The component is implicitly "flow" and the type is implicitly "discards"; interface, device, and control-plane components are out of scope for this IE.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">Hierarchy preserved. The enumeration mirrors the model: both leaves (specific reasons) and structural aggregates are assigned values so collectors can perform coarse or fine roll-ups. For L3, structural aggregates include address-family and cast (v4/v6, unicast/multicast/broadcast).<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">Self-contained decoding. The value alone carries the discard class. Exporters and collectors can still use other IEs (e.g., flowDirection, ipVersion, addresses, ipDiffServCodePoint) for correlation, but they are not required to decode the class.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">Specificity preference.  The scheme encourages reporting the most-specific known class when available; aggregate values provide a fallback when only a
  broader category is known.<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.5">
            <p id="section-3.1-2.5.1">Implementation-friendly ordering. Codes are assigned in preorder traversal (where each parent is numbered before its children) to reflect the model’s hierarchy and simplify range/roll-up handling in implementations.<a href="#section-3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="flowDiscardClass-definition">
<section id="section-3.2">
        <h3 id="name-flowdiscardclass-definition">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-flowdiscardclass-definition" class="section-name selfRef">flowDiscardClass Definition</a>
        </h3>
<p id="section-3.2-1">Name: flowDiscardClass<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Description: Classifies the reason a packet was discarded in a flow, using the hierarchical classification scheme defined in <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span>.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Abstract Data Type: unsigned8<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Data Type Semantics: identifier<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">Units: none<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">Range: 0..39 (values from <a href="#flowDiscardClass-table" class="auto internal xref">Table 1</a>; other values are unassigned and <span class="bcp14">MUST</span> be treated as unknown)<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">Reversibility: reversible (value does not change under flow reversal as per <span>[<a href="#RFC5103" class="cite xref">RFC5103</a>]</span>)<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">Status: current<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">ElementId: TBD<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<p id="section-3.2-10">References: <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span><a href="#section-3.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flowDiscardClass-values">
<section id="section-3.3">
        <h3 id="name-flowdiscardclass-values">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-flowdiscardclass-values" class="section-name selfRef">flowDiscardClass Values</a>
        </h3>
<p id="section-3.3-1"><a href="#flowDiscardClass-table" class="auto internal xref">Table 1</a> defines the values for the flowDiscardClass Information Element mapped from the corresponding <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span> Discard Class.  Codes are assigned in preorder traversal to reflect the hierarchy.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The code points for flowDiscardClass are maintained by IANA in the "flowDiscardClass Values" subregistry of the IPFIX registry.  Future additions or changes are managed via Expert Review as described in <a href="#iana" class="auto internal xref">Section 5</a>.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<span id="name-flow-discard-classification"></span><div id="flowDiscardClass-table">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-flow-discard-classification" class="selfRef">Flow discard classification values and corresponding discard classes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Discard Class</th>
              <th class="text-left" rowspan="1" colspan="1">flowDiscardClass Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l2</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3/v4</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3/v4/unicast</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3/v4/multicast</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3/v4/broadcast</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3/v6</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3/v6/unicast</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">l3/v6/multicast</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors</td>
              <td class="text-left" rowspan="1" colspan="1">9</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l2</td>
              <td class="text-left" rowspan="1" colspan="1">10</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l2/rx</td>
              <td class="text-left" rowspan="1" colspan="1">11</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l2/rx/crc-error</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l2/rx/invalid-mac</td>
              <td class="text-left" rowspan="1" colspan="1">13</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l2/rx/invalid-vlan</td>
              <td class="text-left" rowspan="1" colspan="1">14</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l2/rx/invalid-frame</td>
              <td class="text-left" rowspan="1" colspan="1">15</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l2/tx</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3</td>
              <td class="text-left" rowspan="1" colspan="1">17</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/rx</td>
              <td class="text-left" rowspan="1" colspan="1">18</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/rx/checksum-error</td>
              <td class="text-left" rowspan="1" colspan="1">19</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/rx/mtu-exceeded</td>
              <td class="text-left" rowspan="1" colspan="1">20</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/rx/invalid-packet</td>
              <td class="text-left" rowspan="1" colspan="1">21</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/ttl-expired</td>
              <td class="text-left" rowspan="1" colspan="1">22</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/no-route</td>
              <td class="text-left" rowspan="1" colspan="1">23</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/invalid-sid</td>
              <td class="text-left" rowspan="1" colspan="1">24</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/invalid-label</td>
              <td class="text-left" rowspan="1" colspan="1">25</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/l3/tx</td>
              <td class="text-left" rowspan="1" colspan="1">26</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/internal</td>
              <td class="text-left" rowspan="1" colspan="1">27</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">errors/internal/parity-error</td>
              <td class="text-left" rowspan="1" colspan="1">28</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy</td>
              <td class="text-left" rowspan="1" colspan="1">29</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l2</td>
              <td class="text-left" rowspan="1" colspan="1">30</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l2/acl</td>
              <td class="text-left" rowspan="1" colspan="1">31</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l3</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l3/acl</td>
              <td class="text-left" rowspan="1" colspan="1">33</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l3/policer</td>
              <td class="text-left" rowspan="1" colspan="1">34</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l3/null-route</td>
              <td class="text-left" rowspan="1" colspan="1">35</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l3/rpf</td>
              <td class="text-left" rowspan="1" colspan="1">36</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">policy/l3/ddos</td>
              <td class="text-left" rowspan="1" colspan="1">37</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">no-buffer</td>
              <td class="text-left" rowspan="1" colspan="1">38</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">no-buffer/class</td>
              <td class="text-left" rowspan="1" colspan="1">39</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.3-4">no-buffer/class conveys per-QoS class congestion loss; the specific class (e.g., DSCP/class index, or L2 PCP) <span class="bcp14">SHOULD</span> be exported via the appropriate companion IE in the same record.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implreq">
<section id="section-3.4">
        <h3 id="name-implementation-requirements">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-implementation-requirements" class="section-name selfRef">Implementation Requirements</a>
        </h3>
<div id="impl-semantics">
<section id="section-3.4.1">
          <h4 id="name-semantics-and-scope">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-semantics-and-scope" class="section-name selfRef">Semantics and Scope</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-3.4.1-1">
<li id="section-3.4.1-1.1">
              <p id="section-3.4.1-1.1.1">Scope of this IE. flowDiscardClass <span class="bcp14">MUST</span> be used only to report flow-level discard classification under flow/discards from <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span>. It <span class="bcp14">MUST NOT</span> be used for interface, device, or control-plane discard counters.<a href="#section-3.4.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.1-1.2">
              <p id="section-3.4.1-1.2.1">Enumeration. Exporters <span class="bcp14">MUST</span> encode values only from the IANA “flowDiscardClass Values” subregistry for this IE. Collectors <span class="bcp14">MUST</span> accept both aggregate and leaf values and interpret aggregates as semantic supersets of their descendants.<a href="#section-3.4.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.1-1.3">
              <p id="section-3.4.1-1.3.1">Unknown/Unassigned values. Collectors receiving an unknown or unassigned value <span class="bcp14">MUST</span> treat it as unknown and <span class="bcp14">MUST NOT</span> remap it to another code. Exporters <span class="bcp14">MUST NOT</span> transmit unassigned values.<a href="#section-3.4.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.1-1.4">
              <p id="section-3.4.1-1.4.1">Reversibility. The value of flowDiscardClass <span class="bcp14">MUST NOT</span> change under biflow reversal as defined by <span>[<a href="#RFC5103" class="cite xref">RFC5103</a>]</span>.<a href="#section-3.4.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="impl-exporter">
<section id="section-3.4.2">
          <h4 id="name-exporter-requirements">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-exporter-requirements" class="section-name selfRef">Exporter Requirements</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-3.4.2-1">
<li id="section-3.4.2-1.1">
              <p id="section-3.4.2-1.1.1">Cardinality. A Flow Record <span class="bcp14">MUST</span> contain at most one instance of flowDiscardClass.<a href="#section-3.4.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.2-1.2">
              <p id="section-3.4.2-1.2.1">Multiplicity.  When multiple discard reasons apply to the same flow interval, exporters <span class="bcp14">MUST</span> export multiple Flow Records, one per discard reason.  Each Flow Record <span class="bcp14">MUST</span> carry the same flow keys (5-tuple, interfaces, timestamps) but a distinct flowDiscardClass value.  Where possible, exporters <span class="bcp14">SHOULD</span> include per-reason droppedPacketDeltaCount and/or droppedOctetDeltaCount to quantify the volume attributed to each specific discard class.<a href="#section-3.4.2-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2-1.2.2.1">
                  <p id="section-3.4.2-1.2.2.1.1">While this approach creates multiple Flow Records for the same flow 5-tuple, it provides crucial diagnostic granularity.  Collectors can easily aggregate by summing dropped counts across records with the same flow keys, while preserving the ability to attribute loss to specific root causes.  This design maintains full fidelity of per-reason discard statistics.<a href="#section-3.4.2-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.4.2-1.3">
              <p id="section-3.4.2-1.3.1">Specificity. Exporters <span class="bcp14">SHOULD</span> report the most-specific known class (a leaf). If the specific leaf is unknown, an appropriate parent/aggregate <span class="bcp14">MAY</span> be used.<a href="#section-3.4.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.2-1.4">
              <p id="section-3.4.2-1.4.1">Interval semantics.  When exported on an interval Flow Record, the presence of flowDiscardClass indicates that at least one packet in the interval matched that class.  Exporters <span class="bcp14">MUST</span> include droppedPacketDeltaCount and/or droppedOctetDeltaCount in the same record to quantify the volume attributed to that specific discard reason.  When multiple discard reasons affect the same flow (per point 2), the sum of per-reason dropped counts across all records for that flow represents the total flow-level discards.<a href="#section-3.4.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.2-1.5">
              <p id="section-3.4.2-1.5.1">Congestive loss traffic class (no-buffer/class).<a href="#section-3.4.2-1.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2-1.5.2.1">
                  <p id="section-3.4.2-1.5.2.1.1">If flowDiscardClass equals no-buffer/class, the traffic-class identifier used by the queueing system <span class="bcp14">MUST</span> be present in the same record, carried in exactly one suitable IE (e.g., ipDiffServCodePoint or ipClassOfService for L3, or dot1qPriority for L2).<a href="#section-3.4.2-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.4.2-1.5.2.2">
                  <p id="section-3.4.2-1.5.2.2.1">If classification occurs after remarking, exporters <span class="bcp14">MUST</span> use the corresponding post-class IE where available, or provide a device queue-ID→class mapping via IPFIX Options data.<a href="#section-3.4.2-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.4.2-1.6">
              <p id="section-3.4.2-1.6.1">Context (recommended). To aid correlation with interface/device/control-plane counters, exporters <span class="bcp14">SHOULD</span> include time bounds (flowStart/flowEnd or an observation-time IE), ingressInterface/egressInterface as applicable, and observationPointId when multiple pipeline stages/taps exist.<a href="#section-3.4.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="impl-collector">
<section id="section-3.4.3">
          <h4 id="name-collector-requirements">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-collector-requirements" class="section-name selfRef">Collector Requirements</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-3.4.3-1">
<li id="section-3.4.3-1.1">
              <p id="section-3.4.3-1.1.1">Multiple records per flow.  When multiple Flow Records carry different flowDiscardClass values for the same flow keys and overlapping time intervals, collectors <span class="bcp14">MUST</span> treat them as indicating distinct discard reasons affecting the same flow. Collectors <span class="bcp14">SHOULD</span> aggregate these records when computing per-flow total discards, while preserving per-reason breakdowns for root cause analysis.<a href="#section-3.4.3-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.3-1.2">
              <p id="section-3.4.3-1.2.1">Aggregate handling. When a parent/aggregate class is received, collectors <span class="bcp14">MUST</span> treat it as a coarse classification that may encompass multiple leaves.<a href="#section-3.4.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.3-1.3">
              <p id="section-3.4.3-1.3.1">Congestive loss traffic class. For no-buffer/class, when a traffic-class IE is present, collectors <span class="bcp14">MUST</span> use it to align with per-class counters; if absent, collectors <span class="bcp14">MAY</span> apply local device mappings if available.<a href="#section-3.4.3-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.3-1.4">
              <p id="section-3.4.3-1.4.1">Unknown values. Collectors <span class="bcp14">MUST</span> handle unknown/unassigned values gracefully (e.g., categorize as “unknown”) without rejecting the record.<a href="#section-3.4.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="impl-interop">
<section id="section-3.4.4">
          <h4 id="name-interoperability-with-exist">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-interoperability-with-exist" class="section-name selfRef">Interoperability with Existing IPFIX IEs</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-3.4.4-1">
<li id="section-3.4.4-1.1">
              <p id="section-3.4.4-1.1.1">Exporters and collectors <span class="bcp14">MAY</span> also use existing IEs (e.g., flowDirection, ipVersion, addresses, ipDiffServCodePoint) for filtering, correlation, or redundancy.<a href="#section-3.4.4-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.4-1.2">
              <p id="section-3.4.4-1.2.1">flowDiscardClass alone <span class="bcp14">SHOULD</span> be sufficient to recover the discard classification (apart from the traffic-class identity required for no-buffer/class above).<a href="#section-3.4.4-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.4-1.3">
              <p id="section-3.4.4-1.3.1">Exporters <span class="bcp14">MAY</span> continue to export forwardingStatus (<span>[<a href="#RFC7270" class="cite xref">RFC7270</a>]</span>) in parallel. When both are present, flowDiscardClass <span class="bcp14">SHOULD</span> be considered authoritative for discard classification.<a href="#section-3.4.4-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.4.4-1.4">
              <p id="section-3.4.4-1.4.1">When flow sampling is active, the presence of flowDiscardClass indicates at least one sampled packet matched that class.<a href="#section-3.4.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">This document defines a new Information Element for flow-level discard classification to align with the information model defined in <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span>.  As such, there are no  security issues related to this document, which are additional to those discussed in <span>[<a href="#RFC7011" class="cite xref">RFC7011</a>]</span>, <span>[<a href="#RFC7012" class="cite xref">RFC7012</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">IANA is requested to make the following changes under the IP Flow Information Export (IPFIX) Information Elements registry.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="new-ipfix-information-element-flowdiscardclass">
<section id="section-5.1">
        <h3 id="name-new-ipfix-information-eleme">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-new-ipfix-information-eleme" class="section-name selfRef">New IPFIX Information Element: flowDiscardClass</a>
        </h3>
<p id="section-5.1-1">IANA is requested to register a new Information Element as follows:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">Name: flowDiscardClass<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">ElementId: TBD (to be assigned by IANA)<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.3">
            <p id="section-5.1-2.3.1">Description: Classifies the reason a packet was discarded in a flow, using the hierarchical classification scheme defined in <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span>.<a href="#section-5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.4">
            <p id="section-5.1-2.4.1">Abstract Data Type: unsigned8<a href="#section-5.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.5">
            <p id="section-5.1-2.5.1">Data Type Semantics: identifier<a href="#section-5.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.6">
            <p id="section-5.1-2.6.1">Units: none<a href="#section-5.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.7">
            <p id="section-5.1-2.7.1">Range: 0..38 (values are listed in the “flowDiscardClass Values” subregistry created below; other values are unassigned and <span class="bcp14">MUST</span> be treated as unknown)<a href="#section-5.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.8">
            <p id="section-5.1-2.8.1">Reversibility: reversible (value does not change under flow reversal as per <span>[<a href="#RFC5103" class="cite xref">RFC5103</a>]</span>)<a href="#section-5.1-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.9">
            <p id="section-5.1-2.9.1">Status: current<a href="#section-5.1-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.10">
            <p id="section-5.1-2.10.1">Reference: This document; <span>[<a href="#RFC7013" class="cite xref">RFC7013</a>]</span><a href="#section-5.1-2.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="new-subregistry-flowdiscardclass-values">
<section id="section-5.2">
        <h3 id="name-new-subregistry-flowdiscard">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-new-subregistry-flowdiscard" class="section-name selfRef">New Subregistry: “flowDiscardClass Values”</a>
        </h3>
<p id="section-5.2-1">IANA is requested to create a new subregistry titled "flowDiscardClass Values" under the IPFIX Information Elements registry. This subregistry contains the
enumerated values for the flowDiscardClass IE.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">
            <p id="section-5.2-2.1.1">Registration Procedure: Expert Review (<span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>)<a href="#section-5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">Reference: This document; <span>[<a href="#RFC7013" class="cite xref">RFC7013</a>]</span><a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.3">
            <p id="section-5.2-2.3.1">Fields:<a href="#section-5.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.3.2.1">
                <p id="section-5.2-2.3.2.1.1">Value (integer)<a href="#section-5.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.3.2.2">
                <p id="section-5.2-2.3.2.2.1">Name (path under  flow/discards/...)<a href="#section-5.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.3.2.3">
                <p id="section-5.2-2.3.2.3.1">Description (optional)<a href="#section-5.2-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.3.2.4">
                <p id="section-5.2-2.3.2.4.1">Reference<a href="#section-5.2-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-5.2-3">Designated Expert guidance: New code points should reflect additions to or clarifications of discard reasons in <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span> (or its
successor). Existing code points <span class="bcp14">MUST NOT</span> be repurposed. Backwards-compatible additions are preferred. Experts <span class="bcp14">SHOULD</span> maintain the hierarchical structure
(e.g., assigning aggregates and leaves consistently) and, where practical, preserve preorder (depth-first) numbering to align with the existing tree.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-opsawg-discardmodel">[I-D.ietf-opsawg-discardmodel]</dt>
        <dd>
<span class="refAuthor">Evans, J.</span>, <span class="refAuthor">Pylypenko, O.</span>, <span class="refAuthor">Haas, J.</span>, <span class="refAuthor">Kadosh, A.</span>, and <span class="refAuthor">M. Boucadair</span>, <span class="refTitle">"Information and Data Models for Packet Discard Reporting"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-opsawg-discardmodel-10</span>, <time datetime="2025-11-26" class="refDate">26 November 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-discardmodel-10">https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-discardmodel-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5103">[RFC5103]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span> and <span class="refAuthor">E. Boschi</span>, <span class="refTitle">"Bidirectional Flow Export Using IP Flow Information Export (IPFIX)"</span>, <span class="seriesInfo">RFC 5103</span>, <span class="seriesInfo">DOI 10.17487/RFC5103</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5103">https://www.rfc-editor.org/rfc/rfc5103</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7011">[RFC7011]</dt>
        <dd>
<span class="refAuthor">Claise, B., Ed.</span>, <span class="refAuthor">Trammell, B., Ed.</span>, and <span class="refAuthor">P. Aitken</span>, <span class="refTitle">"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"</span>, <span class="seriesInfo">STD 77</span>, <span class="seriesInfo">RFC 7011</span>, <span class="seriesInfo">DOI 10.17487/RFC7011</span>, <time datetime="2013-09" class="refDate">September 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7011">https://www.rfc-editor.org/rfc/rfc7011</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7012">[RFC7012]</dt>
        <dd>
<span class="refAuthor">Claise, B., Ed.</span> and <span class="refAuthor">B. Trammell, Ed.</span>, <span class="refTitle">"Information Model for IP Flow Information Export (IPFIX)"</span>, <span class="seriesInfo">RFC 7012</span>, <span class="seriesInfo">DOI 10.17487/RFC7012</span>, <time datetime="2013-09" class="refDate">September 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7012">https://www.rfc-editor.org/rfc/rfc7012</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7013">[RFC7013]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span> and <span class="refAuthor">B. Claise</span>, <span class="refTitle">"Guidelines for Authors and Reviewers of IP Flow Information Export (IPFIX) Information Elements"</span>, <span class="seriesInfo">BCP 184</span>, <span class="seriesInfo">RFC 7013</span>, <span class="seriesInfo">DOI 10.17487/RFC7013</span>, <time datetime="2013-09" class="refDate">September 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7013">https://www.rfc-editor.org/rfc/rfc7013</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC7270">[RFC7270]</dt>
      <dd>
<span class="refAuthor">Yourtchenko, A.</span>, <span class="refAuthor">Aitken, P.</span>, and <span class="refAuthor">B. Claise</span>, <span class="refTitle">"Cisco-Specific Information Elements Reused in IP Flow Information Export (IPFIX)"</span>, <span class="seriesInfo">RFC 7270</span>, <span class="seriesInfo">DOI 10.17487/RFC7270</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7270">https://www.rfc-editor.org/rfc/rfc7270</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="correlating">
<section id="appendix-A">
      <h2 id="name-correlating-flow-discards-w">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-correlating-flow-discards-w" class="section-name selfRef">Correlating Flow Discards with Interface/Device/Control-Plane Discards</a>
      </h2>
<p id="appendix-A-1">This appendix is non-normative. It describes how to map high-level interface discard counters (from <span>[<a href="#I-D.ietf-opsawg-discardmodel" class="cite xref">I-D.ietf-opsawg-discardmodel</a>]</span>) to the specific flows responsible for or affected by those discards.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="correlation-keys">
<section id="appendix-A.1">
        <h3 id="name-correlation-keys">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-correlation-keys" class="section-name selfRef">Correlation Keys</a>
        </h3>
<p id="appendix-A.1-1">To correlate a discard counter anomaly with flow records, the collector must join data on three key dimensions:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.1-2">
<li id="appendix-A.1-2.1">
            <p id="appendix-A.1-2.1.1">Time: Align the counter collection interval with the Flow Record start/end times (allowing for small clock skew).<a href="#appendix-A.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.1-2.2">
            <p id="appendix-A.1-2.2.1">Location: Match the Observation Domain and Interface.<a href="#appendix-A.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-2.2.2.1">
                <p id="appendix-A.1-2.2.2.1.1">For Ingress discards: match ingressInterface.<a href="#appendix-A.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.1-2.2.2.2">
                <p id="appendix-A.1-2.2.2.2.1">For Egress discards: match egressInterface.<a href="#appendix-A.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="appendix-A.1-2.3">
            <p id="appendix-A.1-2.3.1">Discard Class: Match the YANG discard-class leaf with the IPFIX flowDiscardClass value.<a href="#appendix-A.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-2.3.2.1">
                <p id="appendix-A.1-2.3.2.1.1">Note: If the drop is specific to a traffic class (e.g., no-buffer/class), the collector must also match the traffic class identifier (e.g., ipDiffServCodePoint) to the specific queue experiencing loss.<a href="#appendix-A.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
</section>
</div>
<div id="analysis-strategies">
<section id="appendix-A.2">
        <h3 id="name-analysis-strategies">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-analysis-strategies" class="section-name selfRef">Analysis Strategies</a>
        </h3>
<p id="appendix-A.2-1">Once flow records are correlated with discard counters, operators can rank or group flows to determine:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-2.1">
            <p id="appendix-A.2-2.1.1">Impacted analysis: Which flows suffered loss? This is determined by grouping flows by the presence of the flowDiscardClass (or summing dropped-octets/packets) to identify the symptomatic flows of the event.<a href="#appendix-A.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.2">
            <p id="appendix-A.2-2.2.1">Causal analysis (when meaningful): Which flows likely contributed to the interface/device condition? For congestive drops (e.g. no-buffer/class), this is determined by identifying the top senders (by total volume or rate) in the same traffic class and egress interface during the anomaly.<a href="#appendix-A.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="impacted-flows">
<section id="appendix-A.3">
        <h3 id="name-operational-example-impacte">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-operational-example-impacte" class="section-name selfRef">Operational Example: Impacted Flows (Congestion Drops)</a>
        </h3>
<p id="appendix-A.3-1">Scenario: an anomaly is detected in no-buffer/class discards on Ethernet1/0 (ifIndex 10) in the egress direction. The drops are occurring in the Best Effort queue (DSCP 0).<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.3-2">
<li id="appendix-A.3-2.1">
            <p id="appendix-A.3-2.1.1">Signal: Interface discard counter<a href="#appendix-A.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3-2.1.2.1">
                <p id="appendix-A.3-2.1.2.1.1">Time: 2025-09-18 10:00:00 – 10:01:00<a href="#appendix-A.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.3-2.1.2.2">
                <p id="appendix-A.3-2.1.2.2.1">Observation Domain: 1234<a href="#appendix-A.3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.3-2.1.2.3">
                <p id="appendix-A.3-2.1.2.3.1">Interface: 10 (egress)<a href="#appendix-A.3-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.3-2.1.2.4">
                <p id="appendix-A.3-2.1.2.4.1">Class: no-buffer/class (value 38; see <a href="#flowDiscardClass-table" class="auto internal xref">Table 1</a>)<a href="#appendix-A.3-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.3-2.1.2.5">
                <p id="appendix-A.3-2.1.2.5.1">Queue/DSCP: 0<a href="#appendix-A.3-2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="appendix-A.3-2.2">
            <p id="appendix-A.3-2.2.1">Correlation: SQL Query<a href="#appendix-A.3-2.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2.2.2">
The operator queries the IPFIX store to perform impact analysis — identifying symptomatic flows of the congestion event:<a href="#appendix-A.3-2.2.2" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2.2.3"><code>sql
SELECT
    src_addr,
    dst_addr,
    l4_dst_port,
    protocol,
    SUM(droppedPacketDeltaCount) AS total_pkt_discards
FROM flow_records
WHERE
    -- 0. Match Observation Domain
    observationDomainId = 1234
    -- 1. Match Location (egress interface)
    AND egressInterface = 10
    -- 2. Match Time Window (any overlap with counter interval)
    AND flowEnd   &gt;= '2025-09-18 10:00:00'
    AND flowStart &lt;= '2025-09-18 10:01:00'
    -- 3. Match Discard Class (no-buffer/class)
    AND flowDiscardClass = 39
    -- 4. Match Traffic Class context (Best Effort)
    AND ipDiffServCodePoint = 0
GROUP BY
    src_addr, dst_addr, l4_dst_port, protocol
ORDER BY
    total_pkt_discards DESC
LIMIT 10;
</code><a href="#appendix-A.3-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.3-2.3">
            <p id="appendix-A.3-2.3.1">Result<a href="#appendix-A.3-2.3.1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2.3.2">
The query returns the top flows most affected by the discard event, allowing the operator to pinpoint specific applications or users impacted by the congestion:<a href="#appendix-A.3-2.3.2" class="pilcrow">¶</a></p>
</li>
        </ol>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">src_addr</th>
              <th class="text-left" rowspan="1" colspan="1">dst_addr</th>
              <th class="text-left" rowspan="1" colspan="1">l4_dst_port</th>
              <th class="text-left" rowspan="1" colspan="1">protocol</th>
              <th class="text-left" rowspan="1" colspan="1">flowDiscardClass</th>
              <th class="text-right" rowspan="1" colspan="1">total_pkt_discards</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">192.0.2.10</td>
              <td class="text-left" rowspan="1" colspan="1">198.51.100.55</td>
              <td class="text-left" rowspan="1" colspan="1">443</td>
              <td class="text-left" rowspan="1" colspan="1">6 (TCP)</td>
              <td class="text-left" rowspan="1" colspan="1">38</td>
              <td class="text-right" rowspan="1" colspan="1">15,400</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">192.0.2.12</td>
              <td class="text-left" rowspan="1" colspan="1">198.51.100.80</td>
              <td class="text-left" rowspan="1" colspan="1">80</td>
              <td class="text-left" rowspan="1" colspan="1">6 (TCP)</td>
              <td class="text-left" rowspan="1" colspan="1">38</td>
              <td class="text-right" rowspan="1" colspan="1">2,100</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="causal-flows">
<section id="appendix-A.4">
        <h3 id="name-operational-example-causal-">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-operational-example-causal-" class="section-name selfRef">Operational Example: Causal Flows (Congestion Drops)</a>
        </h3>
<p id="appendix-A.4-1">Using the same scenario as in <a href="#impacted-flows" class="auto internal xref">Appendix A.3</a>, the operator now wants to identify flows that likely caused the congestion — that is, heavy senders in the affected queue and interface during the anomaly. These flows may or may not themselves have experienced drops.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.4-2">
<li id="appendix-A.4-2.1">
            <p id="appendix-A.4-2.1.1">Signal: Interface discard counter<a href="#appendix-A.4-2.1.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2.1.2">
Same as in Section A.3:<a href="#appendix-A.4-2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.4-2.1.3.1">
                <p id="appendix-A.4-2.1.3.1.1">Time: 2025-09-18 10:00:00 – 10:01:00<a href="#appendix-A.4-2.1.3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.4-2.1.3.2">
                <p id="appendix-A.4-2.1.3.2.1">Observation Domain: 1234<a href="#appendix-A.4-2.1.3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.4-2.1.3.3">
                <p id="appendix-A.4-2.1.3.3.1">Interface: 10 (egress)<a href="#appendix-A.4-2.1.3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.4-2.1.3.4">
                <p id="appendix-A.4-2.1.3.4.1">Class: no-buffer/class (value 38)<a href="#appendix-A.4-2.1.3.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.4-2.1.3.5">
                <p id="appendix-A.4-2.1.3.5.1">Queue/DSCP: 0<a href="#appendix-A.4-2.1.3.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="appendix-A.4-2.2">
            <p id="appendix-A.4-2.2.1">Correlation: SQL Query<a href="#appendix-A.4-2.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2.2.2">
The operator queries the IPFIX store to perform a causal analysis by ranking flows by total traffic volume in the same time window, interface, and traffic class. The query does not require flowDiscardClass = 39, since flows can contribute to congestion even if only some packets (or none of the sampled packets) were dropped.<a href="#appendix-A.4-2.2.2" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2.2.3"><code>sql
SELECT
    src_addr,
    dst_addr,
    l4_dst_port,
    protocol,
    SUM(octetDeltaCount)          AS total_bytes,
    SUM(packetDeltaCount)         AS total_pkts,
    SUM(droppedPacketDeltaCount)  AS total_pkt_discards
FROM flow_records
WHERE
    -- 0. Match Observation Domain
    observationDomainId = 1234
    -- 1. Match Location (egress interface)
    AND egressInterface = 10
    -- 2. Match Time Window (any overlap with counter interval)
    AND flowEnd   &gt;= '2025-09-18 10:00:00'
    AND flowStart &lt;= '2025-09-18 10:01:00'
    -- 3. Match Traffic Class context (Best Effort queue)
    AND ipDiffServCodePoint = 0
GROUP BY
    src_addr, dst_addr, l4_dst_port, protocol
ORDER BY
    total_bytes DESC
LIMIT 10;
</code><a href="#appendix-A.4-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.4-2.3">
            <p id="appendix-A.4-2.3.1">Result<a href="#appendix-A.4-2.3.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2.3.2">
This query returns flows that carried the most traffic through the congested interface and queue during the interval. These high-volume flows are candidates for having contributed to the congestion. The total_drops column (if present) can still be used to see which of these heavy flows also suffered loss.<a href="#appendix-A.4-2.3.2" class="pilcrow">¶</a></p>
</li>
        </ol>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">src_addr</th>
              <th class="text-left" rowspan="1" colspan="1">dst_addr</th>
              <th class="text-left" rowspan="1" colspan="1">l4_dst_port</th>
              <th class="text-left" rowspan="1" colspan="1">protocol</th>
              <th class="text-right" rowspan="1" colspan="1">total_bytes</th>
              <th class="text-right" rowspan="1" colspan="1">total_pkt_discards</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">10.0.0.5</td>
              <td class="text-left" rowspan="1" colspan="1">192.0.2.200</td>
              <td class="text-left" rowspan="1" colspan="1">443</td>
              <td class="text-left" rowspan="1" colspan="1">6 (TCP)</td>
              <td class="text-right" rowspan="1" colspan="1">850,000,000</td>
              <td class="text-right" rowspan="1" colspan="1">2,100</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">192.0.2.10</td>
              <td class="text-left" rowspan="1" colspan="1">198.51.100.55</td>
              <td class="text-left" rowspan="1" colspan="1">443</td>
              <td class="text-left" rowspan="1" colspan="1">6 (TCP)</td>
              <td class="text-right" rowspan="1" colspan="1">15,000,000</td>
              <td class="text-right" rowspan="1" colspan="1">15,400</td>
            </tr>
          </tbody>
        </table>
<p id="appendix-A.4-4">In this example, the flow from 10.0.0.5 transferred 850 MB with limited discards, while the smaller flow from 192.0.2.10 suffered significant packet loss.<a href="#appendix-A.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sampling">
<section id="appendix-A.5">
        <h3 id="name-implementation-note-on-samp">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-implementation-note-on-samp" class="section-name selfRef">Implementation Note on Sampling</a>
        </h3>
<p id="appendix-A.5-1">When flow sampling is active, flowDiscardClass indicates that a sampled packet was dropped.  To estimate the total (unsampled) flow-level impact and compare it with interface counters (which are typically unsampled), operators can apply a sampling-rate multiplier to the flow counters (droppedPacketDeltaCount and/or droppedOctetDeltaCount).<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.5-2">Let:
   *  p = the sampling probability (e.g., 0.01 for 1-in-100 sampling)
   *  N = 1 / p be the corresponding "1-in-N" sampling interval.<a href="#appendix-A.5-2" class="pilcrow">¶</a></p>
<p id="appendix-A.5-3">The sampling-rate multiplier is N.  Estimated totals are then:
   * estimated_total_dropped_packets  = droppedPacketDeltaCount * N
   * estimated_total_dropped_octets   = droppedOctetDeltaCount  * N<a href="#appendix-A.5-3" class="pilcrow">¶</a></p>
<p id="appendix-A.5-4">For example, if the exporter samples 1 in every 100 packets, the multiplier is 100.  If the exporter samples 1 in every 1000 packets, the multiplier is 1000.<a href="#appendix-A.5-4" class="pilcrow">¶</a></p>
<p id="appendix-A.5-5">Exporters typically report their sampling configuration via IPFIX (samplingInterval and/or samplingProbability).  Because sampling is probabilistic, these estimates are approximate; using larger time windows and higher-volume aggregates tends to make them more robust.<a href="#appendix-A.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Evans</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div dir="auto" class="left"><span class="street-address">1 Principal Place, Worship Street</span></div>
<div dir="auto" class="left"><span class="locality">London</span></div>
<div dir="auto" class="left"><span class="postal-code">EC2A 2FA</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jevanamz@amazon.co.uk" class="email">jevanamz@amazon.co.uk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Oleksandr Pylypenko</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div dir="auto" class="left"><span class="street-address">410 Terry Ave N</span></div>
<div dir="auto" class="left">
<span class="locality">Seattle</span>, <span class="region">WA</span> <span class="postal-code">98109</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:opyl@amazon.com" class="email">opyl@amazon.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Karim Cheaito</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div dir="auto" class="left"><span class="street-address">410 Terry Ave N</span></div>
<div dir="auto" class="left">
<span class="locality">Seattle</span>, <span class="region">WA</span> <span class="postal-code">98109</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kcheaito@amazon.com" class="email">kcheaito@amazon.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
